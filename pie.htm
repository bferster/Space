<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8" />
	<link REL="SHORTCUT ICON" HREF="img/shanti.ico">
	<title>Pie demo</title>
 	<script src="//ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>	
	<link rel="stylesheet" href="//ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/themes/smoothness/jquery-ui.css" />
	<script src="//ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>
	<script src="jquery.ui.touch-punch.min.js"></script>
   	<script src="pie.js" type="text/javascript"></script>

 	<style type="text/css">
		body { 			font-family:Verdana,Geneva,sans-serif; font-size:10px; 
						padding:0px;margin:0px;box-sizing:border-box;
						}
		.pi-main {		text-align:center;position:absolute;width:0px,height:0px;
						
						}
		.pi-slice {		position:absolute;width:100%;left:0px;top:0px;
						}
		.pi-subbar {	position:absolute;left:0px;top:0px;
						}
		.pi-colchip {	position:absolute;width:12px;height:12px;
						color:#ff0000;text-align:center;
						}
		.pi-coltext {	position:absolute;width:55px;height:10px;font-size:9px;
						border-radius:10px;padding-top:2px;padding-left:6px;
						border:1px solid #666;color:#666;background-color:#e8e8e8;
						}
		.pi-textopt	{	position:absolute;height:12px;opacity:.75;
						border-radius:12px;padding-bottom:1px;padding-left:5px;padding-right:6px;
						border:1px solid #666;color:#666;background-color:#e8e8e8;
						}
		.pi-type {	position:absolute;width:100px;height:12px;font-size:12px;
						border-radius:12px;padding-top:2px;padding-left:6px;
						border:1px solid #666;color:#666;background-color:#e8e8e8;
						}
		.pi-linechip {	position:absolute;height:12px;background-color:#e8e8e8;
						color:#ff0000;vertical-align:middle;
						}
		.unselectable { -moz-user-select: none;     -khtml-user-select: none;
		   			 	-webkit-user-select: none;  -ms-user-select: none;   user-select: none;
		   				}
		.selectable { 	-moz-user-select: text;     -khtml-user-select: text;
		   			 	-webkit-user-select: text;  -ms-user-select: text;   user-select: text;

 	</style>

</head>
<body>
<img id='fakeback' src='back.JPG'/>
<script>
	var o;
	var pie;
	var ops={x:330,y:334,wid:150,ang:45,slices:[]};
	ops.dial="img/pdraw.png";													// Dial background
	ops.hilite="img/philite.png";												// Slice highlight
	ops.slices[0]={ type:"but" };												// Center 
	ops.slices[1]={ type:"lin", def:1};											// Line width slice 
	ops.slices[2]={ type:"col", def:"#000000"};									// Line col slice 
	ops.slices[3]={ type:"txt"};												// Blank slice 
	ops.slices[4]={ type:"but", close:0};										// Redo slice 
	ops.slices[5]={ type:"but", close:1};										// Undo slice 
	ops.slices[6]={ type:"typ", def:"default"};									// Blank slice 
	ops.slices[7]={ type:"col", def:"#990000"};									// Line col slice 
	ops.slices[8]={ type:"sli", def:100};										// Alpha slice 

	ops.slices[3].options=["Line","Polygon","Circle","Box"] ;

	Sound("click",true);														// Init sound
	Sound("ding",true);															// Init sound
	Sound("delete",true);														// Init sound

$(document).ready(function() {												// ON PAGE LOADED
	isMobile=navigator.userAgent.match(/(ipad|iphone|ipod|android)/i) ? true : false; // Set mobile flag
	var url=window.location.search.substring(1);								// Get query string
	pie=new Pie(ops);															// Init pie menu

	if (window.addEventListener) 												// If supported this way
		window.addEventListener("message",html5MessageHandler,false);			// Add event handler
	else																		// Use other method
		window.attachEvent("message",html5MessageHandler);						// Add handler
	
	$("#fakeback").on("click",function() { pie.ShowPieMenu(!$("#pimenu").width()) }); // Show pie menu on click
	});									

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
// HELPERS
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

	function trace(msg, p1, p2, p3, p4)										// CONSOLE 
	{
		if (p4 != undefined)
			console.log(msg,p1,p2,p3,p4);
		else if (p3 != undefined)
			console.log(msg,p1,p2,p3);
		else if (p2 != undefined)
			console.log(msg,p1,p2);
		else if (p1 != undefined)
			console.log(msg,p1);
		else
			console.log(msg);
	}

	function Sound(sound, mute)												// PLAY SOUND
	{
		var snd=new Audio();													// Init audio object
		if (!snd.canPlayType("audio/mpeg") || (snd.canPlayType("audio/mpeg") == "maybe")) 
			snd=new Audio("img/"+sound+".ogg");									// Use ogg
		else	
			snd=new Audio("img/"+sound+".mp3");									// Use mp3
		if (!mute)																// If not initing or muting	
			snd.play();															// Play sound
		}
		
	function ShadeColor(color, percent) {   
		if (!color)
			return;
		var f=parseInt(color.slice(1),16),t=percent<0?0:255,p=percent<0?percent*-1:percent,R=f>>16,G=f>>8&0x00FF,B=f&0x0000FF;
		return "#"+(0x1000000+(Math.round((t-R)*p)+R)*0x10000+(Math.round((t-G)*p)+G)*0x100+(Math.round((t-B)*p)+B)).toString(16).slice(1);
		}

	function html5MessageHandler(e)											// ON HTML5 MESSAGE
	{
   		if (e && e.data && e.data.match(/PiMenu/))								// If a pimenu message
 			trace(e.data.split("|"))
 	}

</script>
</body></html>
