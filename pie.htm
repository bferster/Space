<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8" />
	<link REL="SHORTCUT ICON" HREF="img/shanti.ico">
	<title>Pie demo</title>
 	<script src="//ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>	
	<link rel="stylesheet" href="//ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/themes/smoothness/jquery-ui.css" />
	<script src="//ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>
	<script src="jquery.ui.touch-punch.min.js"></script>
   	<script src="qdraw.js" type="text/javascript"></script>
   	<script src="pie.js" type="text/javascript"></script>

 	<style type="text/css">
		body { 			font-family:Verdana,Geneva,sans-serif; font-size:10px; 
						padding:0px;margin:0px;box-sizing:border-box;background-color:#eee
						}
		.pi-main {		text-align:center;position:absolute;width:0px,height:0px;
						}
		.pi-slice {		position:absolute;width:100%;left:0px;top:0px;
						}
		.pi-subbar {	position:absolute;left:0px;top:0px;
						}
		.pi-colchip {	position:absolute;width:12px;height:12px;font-size:10px;
						color:#ff0000;text-align:center;background-color:#fff;
						}
		.pi-coltext {	position:absolute;width:50px;height:10px;font-size:9px;
						border-radius:10px;padding-top:2px;padding-left:6px;padding-right:6px;
						border:1px solid #666;color:#666;background-color:#fff;
						}
		.pi-textopt	{	position:absolute;height:12px;opacity:.75;
						border-radius:12px;padding-bottom:1px;padding-left:5px;padding-right:6px;
						border:1px solid #666;color:#666;background-color:#e8e8e8;
						}
		.pi-type {		position:absolute;width:100px;height:12px;font-size:12px;color:#666;
						border-radius:12px;padding-top:2px;padding-left:6px;background-color:#e8e8e8;
						}
		.pi-linechip {	position:absolute;height:15px;background-color:#e8e8e8;
						width:2px;border:.5px solid #ddd;
						}
		.pi-linechip2 {	position:absolute;width:40px;background-color:#e8e8e8;left:0px;
						}
		.pi-arrow {		position:absolute;width:20px;height:5px;background-color:#e8e8e8;left:0px;
						}
		.pi-sliarc {	position:absolute;height:3px;width:3px;background-color:#ddd;opacity:.5;
						color:#999;
						}
		.pi-slidot {	position:absolute;height:11px;width:11px;background-color:#e8e8e8;
						border-radius:12px;border:1px solid #666;
						}
		.pi-icon {		position:absolute;height:24px;width:24px;text-align:center;
						border-radius:24px;opacity:.75;
						}
		.pi-rarr { 	 	position:absolute;width:0;height:0;border-top:8px solid transparent;
						border-bottom:8px solid transparent;border-left:8px solid #e8e8e8;
						}
		.pi-larr { 	 	position:absolute;width:0;height:0;border-top:8px solid transparent;
						border-bottom:8px solid transparent;border-right:8px solid #e8e8e8;
						}
		.pa-main {		position:absolute;width:50px;height:50px;
						background-color:#aaa;border:1px solid #666;box-shadow: 2px 2px 16px;
						
						}
		.pa-dot {		width:31px;height:31px;border-radius:30px;margin:8px;opacity:1;
						}
		.unselectable { -moz-user-select: none;     -khtml-user-select: none;
		   			 	-webkit-user-select: none;  -ms-user-select: none;   user-select: none;
		   				}
		.selectable { 	-moz-user-select: text;     -khtml-user-select: text;
		   			 	-webkit-user-select: text;  -ms-user-select: text;   user-select: text;

 	</style>

</head>
<body>

<img src='back.JPG' style='opacity:1'/>
<div id='containerDiv' style='position:absolute;width:930px;height:583px;left:0px;top:0px'></div>

<script>
	var o;
	var pie,pal;
	var ops={id:"piseg",x:330,y:334,wid:150,ang:45,slices:[]};
//	ops.sy=0;	ops.sx=0;															

	ops.dial="img/piback.png";													// Dial background
	ops.hilite="img/philite.png";												// Slice highlight
	ops.slices[0]={ type:"but", ico:"img/gear-icon.png" };						// Center 
	ops.slices[1]={ type:"ico", ico:"img/draw-icon.png", def:2 };				// Blank slice 
	ops.slices[2]={ type:"edg", ico:"img/edge-icon.png", def:"#000099,2,1"};	// Edge 
	ops.slices[3]={ type:"men", ico:"img/trash-icon.png", close:1};				// Delete slice 
	ops.slices[4]={ type:"but", ico:"img/redo-icon.png", close:0 };				// Redo slice 
	ops.slices[5]={ type:"but", ico:"img/undo-icon.png", close:1 };				// Undo slice 
	ops.slices[6]={ type:"txt", ico:"img/text-icon.png", def:"#009999,12,R,100"};// Text slice 
	ops.slices[7]={ type:"col", ico:"img/color-icon.png", def:"#990000" };		// Color slice 
	ops.slices[8]={ type:"sli", ico:"img/alpha-icon.png", def:100 };			// Alpha slice 

	ops.slices[1].options=["img/line-icon.png","img/box-icon.png","img/circle-icon.png","img/text-icon.png"] ;
	ops.slices[3].options=["Yes","No"] ;

	Sound("click",true);														// Init sound
	Sound("ding",true);															// Init sound
	Sound("delete",true);														// Init sound

$(document).ready(function() {												// ON PAGE LOADED
	isMobile=navigator.userAgent.match(/(ipad|iphone|ipod|android)/i) ? true : false; // Set mobile flag
	var url=window.location.search.substring(1);								// Get query string
	qd=new QDraw("left",50,"containerDiv");										// Init drawing palette
	

	if (window.addEventListener) 												// If supported this way
		window.addEventListener("message",html5MessageHandler,false);			// Add event handler
	else																		// Use other method
		window.attachEvent("message",html5MessageHandler);						// Add handler
	
//	$("#containerDiv").on("click",function() { pie.ShowPieMenu(!$("#pimenu").width()) }); // Show pie menu on click
	});									

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
// HELPERS
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

	function trace(msg, p1, p2, p3, p4)										// CONSOLE 
	{
		if (p4 != undefined)
			console.log(msg,p1,p2,p3,p4);
		else if (p3 != undefined)
			console.log(msg,p1,p2,p3);
		else if (p2 != undefined)
			console.log(msg,p1,p2);
		else if (p1 != undefined)
			console.log(msg,p1);
		else
			console.log(msg);
	}

	function Sound(sound, mute)												// PLAY SOUND
	{
		var snd=new Audio();													// Init audio object
		if (!snd.canPlayType("audio/mpeg") || (snd.canPlayType("audio/mpeg") == "maybe")) 
			snd=new Audio("img/"+sound+".ogg");									// Use ogg
		else	
			snd=new Audio("img/"+sound+".mp3");									// Use mp3
		if (!mute)																// If not initing or muting	
			snd.play();															// Play sound
		}
		
	function ShadeColor(color, percent) {   
		if (!color)
			return;
		var f=parseInt(color.slice(1),16),t=percent<0?0:255,p=percent<0?percent*-1:percent,R=f>>16,G=f>>8&0x00FF,B=f&0x0000FF;
		return "#"+(0x1000000+(Math.round((t-R)*p)+R)*0x10000+(Math.round((t-G)*p)+G)*0x100+(Math.round((t-B)*p)+B)).toString(16).slice(1);
		}

	function html5MessageHandler(e)											// ON HTML5 MESSAGE
	{
   		if (e && e.data)														// If a valid message				
 			qd.HandleMessage(e.data);											// Handle it
 	}

</script>
</body></html>
