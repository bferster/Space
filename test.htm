<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="initial-scale=1, maximum-scale=1, user-scalable=no">
    <title>ArcGIS test</title>
	<link rel="stylesheet" href="https://js.arcgis.com/4.11/esri/themes/light/main.css">
	<script src="https://js.arcgis.com/4.11/"></script>
 	<style>
    	html, body, #viewDiv {	padding:0; margin:0; height:100%; width: 100%;  }
		#infoDiv { position: absolute; top: 15px;  left: 60px; }
		#infoDiv input { border: none; box-shadow: rgba(0, 0, 0, 0.3) 0px 1px 2px; }
	</style>
  </head>
  <body>
	<div id="viewDiv"></div>
	<div id="infoDiv">
		<input  class="esri-component esri-widget--button esri-widget esri-interactive" type="button" id="base-btn" value="B" title="Change base map"/>
		<input  class="esri-component esri-widget--button esri-widget esri-interactive" type="button" id="switch-btn" value="3D" title="Change view" />
	  </div>
	<script>

	var app={ base:null, container: "viewDiv",
			  mapView: null,  sceneView: null, activeView: null,
   			  center: [91.1721, 29.6524], zoom: 12
	    	  };
	
	var switchButton=document.getElementById("switch-btn");
	switchButton.addEventListener("click", function() { SwitchView();  });
	document.getElementById("base-btn").addEventListener("click", function()   { PickBaseMap(); });

	require(["esri/Map","esri/views/MapView","esri/views/SceneView", "esri/widgets/BasemapGallery"],
		function(Map, MapView, SceneView, BasemapGallery) {
		
			var map=new Map({
				basemap: "topo-vector",
				});

			app.activeView=app.mapView=new MapView({
				map: map,
				container: app.container, 
				center: app.center,
				zoom: app.zoom
				});

			app.sceneView=new SceneView( { container:null, map: map	});
	
			app.base = new BasemapGallery({
				view: app.mapView,
				source: { portal: { url: "https://www.arcgis.com", useVectorBasemaps: true } }
				});
			app.base.visible=false;
		});

// HELPERS //////////////////////////////////////////////////////////////////////////////////////

	function PickBaseMap()
	{
		if (app.base.visible)		app.activeView.ui.remove(app.base);
		else						app.activeView.ui.add(app.base,"top-right");
		app.base.visible=!app.base.visible;
	}

	function SwitchView() 
	{
		var is3D=app.activeView.type === "3d";
		var activeViewpoint=app.activeView.viewpoint.clone();
		app.activeView.container=null;
		
		if (is3D) {
			// if the input view is a SceneView, set the viewpoint on the
			// mapView instance. Set the container on the mapView and flag
			// it as the active view
			app.mapView.viewpoint = activeViewpoint;
			app.mapView.container = app.container;
			app.activeView = app.mapView;
			switchButton.value = "3D";
			} 
		else {
			app.sceneView.viewpoint = activeViewpoint;
			app.sceneView.container = app.container;
			app.activeView = app.sceneView;
			switchButton.value = "2D";
			}
	}		

	function trace(msg, p1, p2, p3, p4)									
	{
		if (p4 != undefined)
			console.log(msg,p1,p2,p3,p4);
		else if (p3 != undefined)
			console.log(msg,p1,p2,p3);
		else if (p2 != undefined)
			console.log(msg,p1,p2);
		else if (p1 != undefined)
			console.log(msg,p1);
		else
			console.log(msg);
	}

</script>
</body>
</html>

